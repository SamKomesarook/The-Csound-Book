<html>	<head>		<meta http-equiv="content-type" content="text/html;charset=iso-8859-1">		<meta name="generator" content="Adobe GoLive 4">		<title>Csound Magazine</title>		<meta name="author" content="Hans Mikelson">		<meta name="summary" content="On-line magazine with articles on Csound for synthesis, signal processing, real-time performance, composing and programming.">		<meta name="keywords" content="csound, Csound, computer music, software synthesizer, software synth, digital signal processing, DSP, dsp, algorithmic composition, fractal music, electro-acoustic, electronica, signal processing, synthesis, sound design, audio programming">		<meta name="keywords" content="csound, Csound, computer music, software synthesizer, software synth, digital signal processing, DSP, dsp, algorithmic composition, fractal music, electro-acoustic, electronica, signal processing, synthesis, sound design, audio programming">	</head>	<body bgcolor="white" text="black" link="#000040" vlink="#264624" alink="#e9ca18">		<table border="0">			<tr>				<td valign="top" colspan="2"><a href="../index.html"><img src="../figures/logosm.jpg" border="0" width="291" height="29"></a></td>			</tr>			<tr>				<td valign="top" rowspan="3"><strong>Columns</strong>					<p><a href="../weekly/index.html">Weekly</a></p>					<p><a href="../beginners/index.html">Beginners</a></p>					<p>Synthesis</p>					<p><a href="../processing/index.html">Processing</a></p>					<p><a href="../realtime/index.html">Real-Time</a></p>					<p><strong>Features</strong></p>					<p><a href="../internals/index.html">Internals</a></p>					<p><a href="../composition/index.html">Composition</a></p>					<p><strong>Departments</strong></p>					<p><a href="../links.html">Links</a></p>					<p><a href="../editorial.html">Editorial</a></p>					<p><a href="../contribute.html">Contribute</a></p>					<p><a href="../past.html">Back Issues</a></p>					<p><a href="http://www.csounds.com/"><img src="../figures/csounds1.gif" border="0" width="88" height="31"></a></td>				<td valign="top">					<h2>Terrain Mapping with Dynamic Surfaces</h2>					<p><i>Hans Mikelson</i></p>					<p><a href="mailto:hans@csounds.com">hans@csounds.com</a></p>					<p><a href="dyntern.orc">dyntern.orc</a> <a href="dyntern.sco">dyntern.sco</a></p>					<p><strong>Introduction</strong></p>					<p>In this article I will describe terrain mapping of dynamically modulated surfaces. Terrain mapping results in a large number of parameters which can be controlled and dynamical systems provide an interesting way to control a large number of parameters so the two processes compliment each other.</p>					<p>Terrain mapping is accomplished by tracing a surface with a path or orbit. Samples are generated from the height of the surface along the path. I like to use three (or more) dimensional mathematical surfaces for this. I will usually try several different equations until I generate a surface which looks interesting. I then select an orbit which will work well with this surface. Rose curves seem to make nice orbits because they pass through the center point and can be set up to have different numbers of lobes to catch interesting features of the surface. Sine and cosine functions are useful for adding waves or ridges to the surface. Functions of the form 1/(1+x^2) can be used to add hills or valleys to the surface.</p>					<p><strong>The Planet Surface</strong></p>					<p><img src="cosxysurf.jpg" width="322" height="248"></p>					<pre><strong>Figure 1.</strong>z = cos(x*y) + 1/(1 + ((x+2)*(x+2) + y*y))r = sin(3*t)</pre>					<p>Figure 1 shows a three dimensional surface being scanned by a three lobed rose curve. The ridges occurring roughly in the shape of a cross or '+' sign come from the equation cos(x*y). In addition there is a hill located on the left side of the surface. The parameters defining this surface are modulated by the output of the <strong>planet</strong> opcode. The position of the hill is controlled by the X and Y coordinates of <strong>planet</strong>. The frequency of the ridges is controlled by the Z coordinate of <strong>planet</strong>. The overall amplitude of the surface is controlled by the sum of the X, Y and Z coordinates from <strong>planet</strong>.</p>					<p>Following is the Csound code for this:</p>					<pre>;                    Mass1   Mass2   Sep  X  Y   Z   VX  VY  VZ   h      Frictionaxp, ayp, azp planet imass1, imass2, 2.2, 2, .1, .1, .5, .6, -.1, .0002, .01ascal  =     100 + .1*(ayp + axp +azp)arosl  oscil 4, 3.01*ifqc, 1        ; Rose Curveaxl    oscil arosl, ifqc, 1, .10    ; Convert from polar toayl    oscil arosl, ifqc, 1, .35    ; rectangular coordinatesahill  =     1/(10+(axl-axp*.1)*(axl-axp*.1)+(ayl-ayp*.1)*(ayl-ayp*.1))azl    =     ascal*cos((1+azp*.1)*(axl+1)*(ayl+1)*.7)*ahill</pre>					<p>The X and Y coordinates for the rose curve are generated using three oscil statements. A moving hill is created and added to a rippled Z surface. The Z value is finally scaled and output.</p>					<p><strong>The Lorenz Surface</strong></p>					<p>Figure 2 shows a surface a complex surface traced by a circle. I create hills and valleys on this surface using equations of the form 1/(1+exp(x)). The position of the hills is determined by the X and Y coordinates generated by the <strong>lorenz</strong> opcode. The frequency of the ridges is controlled by the Z coordinate of <strong>lorenz</strong>.</p>					<p><img src="cosyyd2pxx.jpg" width="321" height="295"></p>					<pre><strong>Figure 2.</strong>z = cos(y*y/(2+x*x))r = 4</pre>					<p>The Csound code for instrument 2 is:</p>					<pre>; Lorenz systemaxl, ayl, azl lorenz 10, 28, 8/3, .00001, 9.8, 17.6, 14.8, 1ax      oscil 4, ifqc, 1                  ; Convert from polar toay      oscil 4, ifqc, 1, .25             ; rectangular coordinatesascal   =     1+.02*(axl+ayl+azl)ahv     =     4/(1+exp(ax-axl))-4/(1+exp(ay-ayl))azl     =     ascal*cos((1+.04*ayl)*ay*ay/(2+ax*ax*(1+.04*azl)))+ahv</pre>					<p><strong>Conclusion</strong></p>					<p>The methods presented in this article seem most useful in generating long slowly evolving drones and pads. I have only presented instruments where the parameters of the surface are modulated by the dynamical system but I have also experimented with controlling the parameters of the orbits with the dynamical system.</td>			</tr>			<tr>				<td valign="top" bgcolor="#fdf2e3"><strong>Rose Curves</strong>					<p>A rose curve is a polar equation of the form</p>					<p>r=sin(N*theta)</p>					<p>The parameter N determines the number of lobes the rose curve will have. If N is odd then the rose curve will have N lobes. If N is even then the rose curve will have 2*N lobes. If N is not an integer then a complex shape results in which each loop does not line up on top of next.</td>			</tr>			<tr>				<td valign="top" bgcolor="#f0effe"><strong>Generating the images</strong>					<p>The images for this article were created using POVRay. This program is to 3D imaging what Csound is to sound. Following are links for the Perl script used to create the images in this article as well as links to the POVRay and Perl homepages:</p>					<p><a href="trigraph2pl.txt">trigraph2pl.txt</a> Script used to create the images in this article.</p>					<p><a href="http://www.povray.org/">http://www.povray.org/</a> The POVRay home page.</p>					<p><a href="http://www.perl.com/">http://www.perl.com/</a> The Perl home page.</td>			</tr>		</table>	</body></html>