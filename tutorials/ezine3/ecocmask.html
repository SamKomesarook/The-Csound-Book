<html>	<head>		<meta http-equiv="content-type" content="text/html;charset=iso-8859-1">		<meta name="generator" content="Adobe GoLive 4">		<title>Using CMask in ecological modeling</title>	</head>	<body bgcolor="white" text="black" link="#203939" vlink="#518e8e" alink="#9f0050">		<a href="index.html"><img src="logosm.gif" border="0" alt="Csound Magazine Summer 1999"></a>		<p><a href="beginners/"><font size="2">Beginners</font></a> <a href="synthesis/"><font size="2">Synthesis</font></a> <a href="processing/"><font size="2">Processing</font></a> <a href="realtime/"><font size="2">Real-Time</font></a> <a href="axcsound.html"><font size="2">AXCsound</font></a> <a href="composing/index.html"><font size="2">Composing</font></a> <font size="2">Ecological Modeling</font> <a href="links.html"><font size="2">Links</font></a> <a href="editorial.html"><font size="2">Editorial</font></a></p>		<center>			<h2>Using CMask in Ecological Modeling</h2>		</center>		<center>			<p><a href="http://www.sfu.ca/~dkeller"><font size="2">Dami&aacute;n Keller</font></a><font size="2"><br>			<i>School for the Contemporary Arts<br>			Simon Fraser University<br>			June 1999</i></font></p>		</center>		<p><font size="2"><br>		<br>		<br>		</font>		<hr>		<table cellpadding="5" cellspacing="1" cols="7" align="center" width="100%">			<tr align="center">				<td valign="top"><b>Examples:</b></td>				<td valign="top"><a href="#example1">1</a></td>				<td valign="top"><a href="#example2">2</a></td>				<td valign="top"><a href="#example3">3</a></td>				<td valign="top"><a href="#example4">4</a></td>				<td valign="top"><a href="#example5">5</a></td>				<td valign="top"><a href="#example6">6</a></td>			</tr>		</table>		<hr>		<br>		</p>		<div align="justify">			<p>CMask is a score generator for the audio synthesis language Csound (Vercoe, 1993). This helper application features several functions to produce stochastic events in Csound (Bartetzki, 1997). This short tutorial presents some simple examples and provides the basic features of more elaborate scores used in ecologically-based pieces. Other examples can be found in <b>touch&#185;n&#185;go</b> (Keller, 1999).</p>		</div>		<div align="justify">			<p>This tutorial does not cover the basics of CMask or Csound because manuals for both applications are widely available (cf. <a href="#references">links</a>). As far as possible, we will provide links to definitions and pointers to web documentation. Before getting into the subject we have to warn the user of some limitations in CMask:</p>		</div>		<div align="justify">			<ul>				<li>It is a batch-mode application, so the user gets feedback after the sound has been generated by Csound (that may be a few seconds, or a few hours later).<br>				<br>			</div>			<li>It ignores its output, so it only allows for a top-down compositional approach.<br>			<br>			<li>It lacks state-dependent parameter control. All variables are defined at initialization time and cannot be changed according to the state of other variables.<br>			<br>			<li>It lacks state-dependent time control. Duration of an event is defined at initialization time.<br>		</ul>		<div align="justify">			<p>To overcome these limitations we have resorted to other software to generate the Csound scores: AC Toolbox (Berg, 1998), Alcaucil (Keller, 1998). Nevertheless, CMask has proven to be useful for synthesizing several sound classes. The working method that we present in this tutorial covers a few classes of ecologically-modeled sounds, and provides some basic examples of the ecological approach to sound resynthesis. No attempt is made to cover theoretical and conceptual issues which are already discussed in other sources (cf. Keller &amp; Truax, 1998; Keller &amp; Rolfe, 1998; Keller, 1999b).<br>			<br>			<br>			<br>			</p>		</div>		<h3>Conventions</h3>		<div align="justify">			<p>Throughout this tutorial, we use the word event to define a sound produced by the combination of multiple grains (in the order of hundreds to thousands). The grains are previously sampled and edited sounds which keep their original spectral and temporal qualities (Keller &amp; Truax, 1998). Thus, a single event is generated by this procedure:</p>		</div>		<div align="justify">			<ul>				<li>Select and edit a number of sound samples (source files) in a sound editor.<br>				<br>			</div>			<li>Generate a single-section score in CMask.<br>			<br>			<li>Synthesize the event in Csound by loading an orchestra, the produced score, and the necessary samples.<br>			<br>		</ul>		<div align="justify">			<p>We have tried to keep some consistency by following Csound syntax conventions in the score formatting process. Resolution is always kept at 5 decimal places for floating point variables, and at integer for integer variables (usually used for <b>ftable</b> numbers). In CMask syntax it is indicated thus:			<table cellpadding="10" cellspacing="1" cols="1" align="center" width="100%">				<tr>					<td width="100%" valign="top"><code>prec 5 &nbsp;&nbsp; ; 5 decimal places (0.00000).<br>						<br>						prec 0 &nbsp;&nbsp; ; integer.</code></td>				</tr>			</table>			</p>		</div>		<div align="justify">			<p>Most parameter values are normalized (0 to 1 range) and scaled in the Csound instrument. We keep the sound file&#185;s original amplitude and select the scaling option in Csound to avoid clipping.<br>			<br>			<br>			<br>			</p>		</div>		<h3>Parameter fields</h3>		<div align="justify">			<p>Each CMask parameter stands for a pfield in Csound. <b>p1</b> to <b>p3</b> are mandatory to get any output from CMask. To simplify notation, we have not included these parameters in the examples. So the user should add them when trying out the examples. All our Csound instruments read each line score by this convention (<b>p</b> stands for pfield or parameter field):			<table cellpadding="20" cellspacing="1" cols="2" align="center" width="100%">				<tr>					<td width="50%" valign="top"><code>(mono)<br>						<br>						p1 instrument number<br>						<br>						p2 onset time<br>						<br>						p3 duration<br>						<br>						p4 amplitude<br>						<br>						p5 frequency<br>						<br>						p6 sound file<br>						<br>						</code></td>					<td width="50%" valign="top"><code>(stereo)<br>						<br>						p1 instrument number<br>						<br>						p2 onset time<br>						<br>						p3 duration<br>						<br>						p4 amplitude<br>						<br>						p5 frequency left channel<br>						<br>						p6 frequency right channel<br>						<br>						p7 sound file left channel<br>						<br>						p8 sound file right channel<br>						<br>						</code></td>				</tr>			</table>			</p>		</div>		<h3>Sound files</h3>		<div align="justify">			<p><b>ftables</b> provide the fastest way to keep sounds available in RAM. When using stereo files, care should be taken to keep the stereo image by using consistent playback of the two channels (of course, sometimes this is not wanted or needed). Here is a typical <b>ftable</b> statement:			<table cellpadding="20" cellspacing="1" cols="1" align="center" width="100%">				<tr>					<td width="100%" valign="top"><code>f2 0 65536 -1 &#179;soundfile.sd2&#178; 0 4 1 ; left channel<br>						f3 0 65536 -1 &#179;soundfile.sd2&#178; 0 4 2 ; right channel</code></td>				</tr>			</table>			</p>		</div>		<div align="justify">			<p>We reserve <b>ftable</b> 1 for the windowing function. While using several dozens (or hundreds) of sound files, we felt the need to automate this process a bit. So we made some <a href="http://www.sfu.ca/~dkeller/download.html">Applescripts</a> for BBEdit 4.0 to write the file names and the trapezoidal window function.<br>			<br>			<br>			<br>			</p>		</div>		<h3>Interpolation</h3>		<div align="justify">			<p>There are three types of interpolation available in CMask (we encourage to use always one of them):<br>			<br>			<table cellpadding="5" cellspacing="1" cols="2" align="center" width="100%">				<tr>					<td width="15%" valign="top"><code>ipl 0<br>						<br>						ipl 1.5<br>						<br>						ipl -1<br>						<br>						ipl cos </code></td>					<td width="85%" valign="top"><code>; linear: a straight line between initial and end value.<br>						<br>						; exponential: a convex curve when the sign is positive.<br>						<br>						; a concave curve when the sign is negative.<br>						<br>						; half-cosine: useful when doing smooth transitions between adjoining events.</code></td>				</tr>			</table>			<br>			<br>			<br>			<br>			</p>		</div>		<h3>Random functions</h3>		<div align="justify">			<p>There are two possible uses of random functions in CMask: (1) fixed range, (2) time-varying range. In the fixed range case, the low and high boundaries are kept constant throughout the event duration. For the time-varying range a tendency mask is employed.<br>			<br>			<br>			<a name="example1"></a><b>Example 1</b><br>			<table cellpadding="10" cellspacing="1" cols="2" align="center" width="100%">				<tr>					<td width="50%" valign="top"><code>f 0 5<br>						<br>						p1 range .1 .3<br>						<br>						prec 5 </code></td>					<td width="50%" valign="top"><b><code>; Fixed range</code></b><code><br>						<br>						; random function.<br>						<br>						; low boundary = .1, high boundary = .3. </code></td>				</tr>			</table>			<br>			<br>			<table cellpadding="10" cellspacing="1" cols="2" align="center" width="100%">				<tr>					<td width="50%" valign="top"><code>f 0 5<br>						<br>						p1 range .1 2<br>						<br>						mask [.1 1] [.3 2]<br>						<br>						prec 5 </code></td>					<td width="50%" valign="top"><b><code>; Time-varying range</code></b><code><br>						<br>						; random function.<br>						<br>						; initial low boundary = .1<br>						<br>						; initial high boundary = .3,<br>						<br>						; final low boundary = 1<br>						<br>						; initial high boundary = 2 </code></td>				</tr>			</table>			</p>		</div>		<div align="justify">			<p>In the fixed range example, the grain onsets will be constantly spread between 10 and 30 ms. In the second example, the density will begin at a 10 to 30 ms. range and will finish at a range of 1 to 2 seconds once the five-second event duration has elapsed.<br>			<br>			<br>			<br>			</p>		</div>		<h3>Random to deterministic transitions</h3>		<div align="justify">			<p>There are two methods in CMask to establish transitions from random values to deterministic patterns. One is to use a tendency mask to reduce the range until a single value is reached. Another one is to set a grid of values using <b>quant</b>. Then change the degree of randomness around the deterministic grid.<br>			<br>			<br>			<a name="example2"></a><b>Example 2</b><br>			<table cellpadding="10" cellspacing="1" cols="2" align="center" width="100%">				<tr>					<td width="100%" valign="top"><code>f 0 5<br>						<br>						p5 range .8 1.2<br>						<br>						mask [.8 1] [1.2 1]<br>						<br>						prec 5<br>						<br>						</code></td>				</tr>			</table>			</p>		</div>		<div align="justify">			<p>In this example, the playback frequency of the sound file is randomly varied within a range of 20% higher and 20% lower sample rates. This range is shrunk until the original frequency is reached after 5 seconds.<br>			<br>			<br>			<a name="example3"></a><b>Example 3</b><br>			<table cellpadding="10" cellspacing="1" cols="2" align="center" width="100%">				<tr>					<td width="50%" valign="top"><code>f 0 5<br>						<br>						p4 range 0 1<br>						<br>						quant .2 [1 0] .1<br>						<br>						prec 5 </code></td>					<td width="50%" valign="top"><code>; random function, range = 0-1<br>						<br>						; grid parameters: interval = .2<br>						<br>						; strength = 0 to 1<br>						<br>						; offset = .1 </code></td>				</tr>			</table>			</p>		</div>		<div align="justify">			<p>In this case, we set a grid for the amplitude values at an interval of .2, that is (0, .2, .4, .6, .8, 1). Given that the strength parameter is set to maximum, 1, the only amplitudes values that we&#185;ll get are the ones in the grid. Let&#185;s say that we do not want any silence (amplitude = 0). Then we set the third parameter, offset, to .1. This adds .1 to all values so we will get values from .1 to 1.1, and the grid will become (.1, .3, .5, .7, .9, 1.1). As time passes, the grid strength is reduced until reaching 0. At 5 seconds, the grid disappears and we are left with a random distribution.<br>			<br>			<br>			<br>			</p>		</div>		<h3>Bubble-gum functions</h3>		<div align="justify">			<p>Most ecological sound models are constrained to a small variation in their time-spans. Their timbral characteristics are directly linked to their evolution through time. By keeping parameters linked to the time-axis we allow for changes in their time-scale without affecting their mesostructure and without having to remap parameters. In simple words, bubble-gum functions work as a <i>bandoneon</i>. They adapt to the &#140;length&#185; they are given. These functions are defined by:<br>			</p>		</div>		<ul>			<li>initial time<br>			<br>			<li>parameter function<br>			<br>			<li>end time		</ul>		<p><br>		<br>		<a name="example4"></a><b>Example 4</b><br>		<table cellpadding="10" cellspacing="1" cols="2" align="center" width="100%">			<tr>				<td width="50%" valign="top"><code>f 0 1<br>					<br>					p4 seg [1 0 ipl 0]<br>					<br>					prec 5 </code></td>				<td width="50%" valign="top"><code>; time-span = 1 second<br>					<br>					; pfield 4 = a line going from 1 to 0.<br>					<br>					; Interpolation = linear.<br>					<br>					; Precision = five decimals. (0.00000).</code></td>			</tr>		</table>		<table cellpadding="10" cellspacing="1" cols="2" align="center" width="100%">			<tr>				<td width="50%" valign="top"><code>f 0 2<br>					<br>					p4 seg [1 0 ipl 0]<br>					<br>					prec 5 </code></td>				<td width="50%" valign="top"><code>; time-span = 2 seconds<br>					<br>					; pfield 4 = a line going from 1 to 0.<br>					<br>					; Interpolation = linear.<br>					<br>					; Precision = five decimals. (0.00000). </code></td>			</tr>		</table>		<br>		<br>		In this example, the event duration is extended from 1 second to 2 seconds. We can use exactly the same CMask function because we indicated only initial and end time. This is accomplished by using <code>[ ]</code> instead of <code>( )</code> (cf. CMask <a href="#references">manual</a> for details on the syntax). Thus, <code>[1 0 ipl 0]</code> replaces the breakpoint function <code>(0 1 1 0 ipl 0)</code>.<br>		<br>		<br>		<br>		</p>		<h3>Concatenating sub-events</h3>		<div align="justify">			<p>When synthesizing complex events, such as breaking glass or multi-bouncing patterns, sometimes we need to combine several sub-events. When a seamless transition is desired half-cosine interpolation can be used to concatenate the grain distribution of two sub-events. Extending the previous example:<br>			<br>			<br>			<a name="example5"></a><b>Example 5</b><br>			<table cellpadding="10" cellspacing="1" cols="2" align="center" width="100%">				<tr>					<td width="50%" valign="top"><code>f 0 5 p4 range 0 1<br>						<br>						mask [0 1 ipl cos] [.1 1 ipl cos]<br>						<br>						prec 5 </code></td>					<td width="50%" valign="top"><code>; first sub-event.<br>						<br>						; half-cosine interpolation. </code></td>				</tr>			</table>			<table cellpadding="10" cellspacing="1" cols="2" align="center" width="100%">				<tr>					<td width="50%" valign="top"><code>f 5 10 p4 range 0 1<br>						<br>						mask [1 0 ipl cos] [1 .1 ipl cos]<br>						<br>						prec 5 </code></td>					<td width="50%" valign="top"><code>; second sub-event.<br>						<br>						; half-cosine interpolation. </code></td>				</tr>			</table>			</p>		</div>		<div align="justify">			<p>By combining two sub-events of 5 seconds, we get a ten-second event with an amplitude profile going from 0-.1 to 1-1 and back to 0-.1. No discontinuity or sudden peak will be produced at 5 seconds.<br>			<br>			<br>			<br>			</p>		</div>		<h3>Three CMask operators: accum, mask, and quant</h3>		<div align="justify">			<p><b>accum</b>, <b>mask</b>, and <b>quant</b> have been widely used in ecological models. So we provide some CMask examples to show how they can be employed in simple tasks. <b>accum</b> has been used to implement a scraper model. <b>quant</b> allowed us to produce a continuum of voice-like clusters which slowly turn into a rich harmonic sound (cf. <b>Vox Populi</b> in <b>touch&#185;n&#185;go</b>).<br>			<br>			<br>			<a name="example6"></a><b>Example 6</b><br>			<br>			<br>			<table cellpadding="10" cellspacing="1" cols="3" align="center" width="100%">				<tr>					<td width="33%" valign="top"><b>accum</b><br>						<ol>							<li><a href="examples/accum/accumtest.msk">accumtest.msk</a>							<li><a href="examples/accum/accumtest.orc">accumtest.orc</a>							<li><a href="examples/accum/accumtest1.msk">accumtest1.msk</a>						</ol>						<p><br>						<b>Samples</b><br>						</p>						<ol>							<li>bot.sd2							<li>metal.sd2						</ol>					</td>					<td width="33%" valign="top"><b>quant</b><br>						<ol>							<li><a href="examples/quant/quantest.msk">quantest.msk</a>							<li><a href="examples/quant/quantest.orc">quantest.orc</a>							<li><a href="examples/quant/quantest1.msk">quantest1.msk</a>							<li><a href="examples/quant/quantest2.msk">quantest2.msk</a>							<li><a href="examples/quant/quantest3.msk">quantest3.msk</a>						</ol>					</td>					<td width="33%" valign="top"><b>mask</b><br>						<ol>							<li><a href="examples/mask/mask2events.msk">mask2events.msk</a>							<li><a href="examples/mask/mask2events.orc">mask2events.orc</a>							<li><a href="examples/mask/masktest.msk">masktest.msk</a>							<li><a href="examples/mask/masktest.orc">masktest.orc</a>							<li><a href="examples/mask/masktest1.msk">masktest1.msk</a>							<li><a href="examples/mask/masktest2.msk">masktest2.msk</a>							<li><a href="examples/mask/masktest3.msk">masktest3.msk</a>							<li><a href="examples/mask/masktest4.msk">masktest4.msk</a>							<li><a href="examples/mask/masktest5.msk">masktest5.msk</a>						</ol>					</td>				</tr>			</table>			</p>		</div>		<div align="justify">			<p>(Reminder: when synthesizing the examples, do not forget to place the two samples provided, in the Csound sample folder. The samples are in Sound Designer II format.)<br>			<br>			<br>			<br>			<a name="references"></a></p>		</div>		<h3>References and links</h3>		<p>Bartetzki, A. (1997). <i>CMask.</i> Csound score generator. Berlin: STEAM.<br>		<a href="ftp://ftp.kgw.tu-berlin.de/pub/cmask/">ftp://ftp.kgw.tu-berlin.de/pub/cmask/</a><br>		<a href="http://www.kgw.tu-berlin.de/%7Eabart/CMaskMan/CMask-Manual.htm">http://www.kgw.tu-berlin.de/~abart/CMaskMan/CMask-Manual.htm</a><br>		</p>		<p>Berg, P. (1998). <i>Algorithmic Composer Toolbox.</i> Macintosh PPC application. The Hague.</p>		<p>Keller, D. (1998). <i>Alcaucil.</i> Csound score generator for ecologically-based granular synthesis. Burnaby, BC: Simon Fraser University.<br>		<a href="http://www.sfu.ca/~dkeller/download.html">http://www.sfu.ca/~dkeller/download.html</a><br>		</p>		<p>Keller, D. (1999a). <i>touch'n'go / toco y me voy.</i> Compact Disc. Burnaby. BC: earsay productions.<br>		<a href="http://www.earsay.com">http://www.earsay.com</a><br>		</p>		<p>Keller, D. (1999b). <i>touch'n'go: Ecological Models in Composition.</i> Master of Fine Arts thesis. Burnaby, BC: Simon Fraser University.<br>		<a href="http://www.sfu.ca/sonic-studio/EcoModelsComposition/Title.html">http://www.sfu.ca/sonic-studio/srs</a><br>		</p>		<p>Keller, D., &amp; Rolfe, C. (1998). The corner effect. <i>Proceedings of the XXI Colloquium in Musical Informatics.</i> Gorizia, Italy.<br>		<a href="http://www.sfu.ca/~dkeller/CornerEffect/CornerEffect.html">http://www.sfu.ca/~dkeller/CornerEffect/CornerEffect.html</a><br>		</p>		<p>Keller, D., &amp; Truax, B. (1998). Ecologically-based granular synthesis. <i>Proceedings of the International Computer Music Conference.</i> Ann Arbor, IL: ICMA.<br>		<a href="http://www.sfu.ca/~dkeller/EcoGranSynth/EGSpaper.html">http://www.sfu.ca/~dkeller/EcoGranSynth/EGSpaper.html</a><br>		</p>		<p>Vercoe, B. (1993). <i>Csound.</i> Cambridge, MA: MIT Media Lab.<br>		<a href="http://www.leeds.ac.uk/music/Man/c_front.html">http://www.leeds.ac.uk/music/Man/c_front.html</a><br>		<a href="http://mitpress.mit.edu/e-books/csound/frontpage.html">http://mitpress.mit.edu/e-books/csound/frontpage.html</a><br>		<br>		<br>		<br>		<hr>		<table cellpadding="5" cellspacing="1" cols="7" align="center" width="100%">			<tr align="center">				<td valign="top"><b>Examples:</b></td>				<td valign="top"><a href="#example1">1</a></td>				<td valign="top"><a href="#example2">2</a></td>				<td valign="top"><a href="#example3">3</a></td>				<td valign="top"><a href="#example4">4</a></td>				<td valign="top"><a href="#example5">5</a></td>				<td valign="top"><a href="#example6">6</a></td>			</tr>		</table>		<hr>		<br>		Send comments to:<br>		</p>		<address><a href="mailto:dkeller@sfu.ca">dkeller@sfu.ca</a></address>		<p><br>		<a href="index.html"><img src="logosm.gif" border="0" alt="Csound Magazine Summer 1999"></a></p>		<p><a href="beginners/"><font size="2">Beginners</font></a> <a href="synthesis/"><font size="2">Synthesis</font></a> <a href="processing/"><font size="2">Processing</font></a> <a href="realtime/"><font size="2">Real-Time</font></a> <a href="axcsound.html"><font size="2">AXCsound</font></a> <a href="composing/index.html"><font size="2">Composing</font></a> <font size="2">Ecological Modeling</font> <a href="links.html"><font size="2">Links</font></a> <a href="editorial.html"><font size="2">Editorial</font></a>	</body></html>