<html>	<head>		<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">		<meta name="GENERATOR" content="Microsoft FrontPage Express 2.0">		<title>Processing</title>	</head>	<body bgcolor="#FFFFFF" link="#0000FF" vlink="#800080">		<h2>The Talk-Box and Formant Filtering</h2>		<p><font size="2"><i>Hans Mikelson</i></font></p>		<p><a href="mailto:hans@csounds.com"><font size="2">hans@csounds.com</font></a></p>		<p><a href="tokbox.orc"><font size="2">tokbox.orc</font></a> <a href="tokbox.sco"><font size="2">tokbox.sco</font></a></p>		<p><font size="2"><b>Introduction</b></font></p>		<p><font size="2">The talk-box made its popular debut in the song &quot;Rocky Mountain Way&quot; by Joe Walsh. This unique &quot;talking guitar&quot; sound immediately established its niche in audio signal processing. In this article I describe how a talk-box works and how to simulate one using Csound.</font></p>		<p><font size="2"><b>How to build a talk-box</b></font></p>		<p><font size="2">A talk-box is made by completely enclosing a speaker except for a small opening to which a plastic tube is attached. The sound is typically produced by an electric guitar which is then amplified by an overdriven tube amplifier which increases the harmonic content of the signal. The guitar amplifier must be able to supply a powered signal to the talk-box. The talk-box typically uses a horn speaker to direct the sound into the tube. The tube transmits the sound from the enclosure to the musician's mouth. The sound is modified by the musician's vocal tract and then passes into a microphone. The microphone signal is then amplified by a second amplifier to achieve the final result. </font></p>		<p><font size="2"><img src="Image97.gif" width="546" height="224" sgi_src="/ptmp/csound/ezine/Image97.gif"></font></p>		<pre><b>Figure 1</b>A typical talk-box configuration</pre>		<p><font size="2"><b>Simulating the talk-box</b></font></p>		<p><font size="2">The talk-box can be simulated with formant filtering. The shape of the vocal tract adds specific resonances to glottal pulses which transforms the pulses into different vowel sounds. These resonances can be simulated by a series of band pass filters at specific frequencies and amplitudes. Some typical formant frequencies are listed in the following table:</font></p>		<table border="0">			<tr>				<td><font size="2">Vowel</font></td>				<td><font size="2">&quot;ee&quot;</font></td>				<td><font size="2">&quot;i&quot;</font></td>				<td><font size="2">&quot;e&quot;</font></td>				<td><font size="2">&quot;ae&quot;</font></td>				<td><font size="2">&quot;ah&quot;</font></td>				<td><font size="2">&quot;aw&quot;</font></td>				<td><font size="2">&quot;u^&quot;</font></td>				<td><font size="2">&quot;oo&quot;</font></td>				<td><font size="2">&quot;u&quot;</font></td>				<td><font size="2">&quot;er&quot;</font></td>			</tr>			<tr>				<td><font size="2">Male spoken</font></td>				<td>					<pre>27022903010</pre>				</td>				<td>					<pre>39019902550</pre>				</td>				<td>					<pre>53018402480</pre>				</td>				<td>					<pre>66017202410</pre>				</td>				<td>					<pre>73010902440</pre>				</td>				<td>					<pre>5708402410</pre>				</td>				<td>					<pre>44010202240</pre>				</td>				<td>					<pre>3008702240</pre>				</td>				<td>					<pre>64011902390</pre>				</td>				<td>					<pre>49013501690</pre>				</td>			</tr>			<tr>				<td><font size="2">Male sung</font></td>				<td>					<pre>30019502750</pre>				</td>				<td>					<pre>37518102500</pre>				</td>				<td>					<pre>53015002500</pre>				</td>				<td>					<pre>62014902250</pre>				</td>				<td>					<pre>70012002600</pre>				</td>				<td>					<pre>61010002600</pre>				</td>				<td>					<pre>4007202500</pre>				</td>				<td>					<pre>3506402550</pre>				</td>				<td>					<pre>50012002675</pre>				</td>				<td>					<pre>40011502500</pre>				</td>			</tr>			<tr>				<td><font size="2">Female spoken</font></td>				<td>					<pre>31027903310</pre>				</td>				<td>					<pre>43024803070</pre>				</td>				<td>					<pre>61023302990</pre>				</td>				<td>					<pre>86020502850</pre>				</td>				<td>					<pre>85012202810</pre>				</td>				<td>					<pre>5909202710</pre>				</td>				<td>					<pre>47011602680</pre>				</td>				<td>					<pre>3709502670</pre>				</td>				<td>					<pre>76014002780</pre>				</td>				<td>					<pre>50016401960</pre>				</td>			</tr>			<tr>				<td><font size="2">Female sung</font></td>				<td>					<pre>40022503300</pre>				</td>				<td>					<pre>47521003450</pre>				</td>				<td>					<pre>55017503250</pre>				</td>				<td>					<pre>60016503000</pre>				</td>				<td>					<pre>70013003250</pre>				</td>				<td>					<pre>62512403250</pre>				</td>				<td>					<pre>4259003375</pre>				</td>				<td>					<pre>4008003250</pre>				</td>				<td>					<pre>55013003250</pre>				</td>				<td>					<pre>45013503050</pre>				</td>			</tr>			<tr>				<td><font size="2">Child spoken</font></td>				<td>					<pre>37032003730</pre>				</td>				<td>					<pre>53027303600</pre>				</td>				<td>					<pre>69026103570</pre>				</td>				<td>					<pre>101023203320</pre>				</td>				<td>					<pre>103013703170</pre>				</td>				<td>					<pre>68010603180</pre>				</td>				<td>					<pre>56014103310</pre>				</td>				<td>					<pre>43011703260</pre>				</td>				<td>					<pre>85015903360</pre>				</td>				<td>					<pre>56018202160</pre>				</td>			</tr>			<tr>				<td><font size="2">Amplitudes (db)</font></td>				<td>					<pre>-4-24-28</pre>				</td>				<td>					<pre>-3-23-27</pre>				</td>				<td>					<pre>-2-17-24</pre>				</td>				<td>					<pre>-1-12-22</pre>				</td>				<td>					<pre>-1-5-28</pre>				</td>				<td>					<pre>0-7-34</pre>				</td>				<td>					<pre>-1-12-34</pre>				</td>				<td>					<pre>-3-19-43</pre>				</td>				<td>					<pre>-1-10-27</pre>				</td>				<td>					<pre>-5-15-20</pre>				</td>			</tr>		</table>		<p><font size="2">The talk-box is simulated by passing the audio signal through three band-pass filters with frequencies centered on the formant frequencies. The filtered signals are then scaled according to the amplitudes in the table and added together before the resultant sound is generated. To produce a more significant response from the formants the harmonic content of the signal is increased. In the case of the original talk-box this is done with the guitar amplifier. In the simulated talk-box I use hyperbolic tangent waveshaping. To implement a formant filter in Csound I used three butterbp filters on the distorted signal. The three filtered signals are then scaled by the formant amplitudes and added together before output.</font></p>		<pre>aform1 butterbp adist, kfrm1p, kfrm1p/ibw ; Compute the three resonancesaform2 butterbp adist, kfrm2p, kfrm2p/ibwaform3 butterbp adist, kfrm3p, kfrm3p/ibwaout = (aform1*kamp1p+aform2*kamp2p+aform3*kamp3p)/5 ; Scale and sum outs aout*kdeclick, aout*kdeclick ; Write to the output channel</pre>		<p><font size="2">Each vowel is referenced by a number from 0 to 9. These numbers are stored in a table to make it easy to generate different vowel sweeps. The following table defines an &quot;ahhhoooh&quot; vowel sweep:</font></p>		<pre>f30 0 8 -2 4 4 4 4 7 7 7 7</pre>		<p><font size="2">This index is then used to reference tables for each of the formants and for the amplitude. The <b>port</b> opcode is used to create a smoothe sweep from one vowel to the next. This is implmented in the following Csound code where each formant frequency and amplitude is obtained and then swept using port.</font></p>		<pre>kformi oscil 1, 1/idur, ixtab    ; Read the formant index tablekform1 table kformi, ifmtab1     ; Read the first formant frequencykdb1 table kformi, iatab1        ; Read the first formant dB'skamp1 = dbamp(60+kdb1)           ; Convert from decibels to amplitudekform2 table kformi, ifmtab2     ; Read the second formant frequencykdb2 table kformi, iatab2        ; Read the second formant dB'skamp2 = dbamp(60+kdb2)           ; Convert dB to ampkform3 table kformi, ifmtab3     ; Read the third formant frequencykdb3 table kformi, iatab3        ; Read the third formnat dB'skamp3 = dbamp(60+kdb3)           ; Convert dB to ampkfrm1p port kform1, iptime, 300  ; Portamento to the next formantkamp1p port kamp1, iptime, .15   ; Portamento to the next amplitudekfrm2p port kform2, iptime, 2000 ; Repeat for secondkamp2p port kamp2, iptime, .15kfrm3p port kform3, iptime, 4000 ; and again for the thirdkamp3p port kamp3, iptime, .15</pre>		<p><font size="2"><b>Conclusion</b></font></p>		<p><font size="2">One of the major problems of the original talk-box is that having the tube in your mouth for an extended performance is very uncomfortable. Another problem is the complex set up required for a talk-box. Formant filtering can come close to creating the vintage talk-box effect without the hassle.</font></p>		<p><font size="2"><b>References</b></font></p>		<p><font size="2">Rossing, Thomas D. 1982. <i>The Science of Sound.</i> Addison-Wesley Publishing Company. pp. 290, 320.</font></p>		<p><font size="2"><b>Links</b></font></p>		<p><font size="2">An excellent table of formants may be found in the PDF Csound manual available from </font><a href="http://www.lakewoodsound.com/csound/"><font size="2">http://www.lakewoodsound.com/csound/</font></a></p>		<p><font size="2"><b>Suggested Listening</b></font></p>		<p><font size="2">Walsh, Joe. 1972. &quot;Rocky Mountain Way.&quot; <i>The Smoker You Drink the Player You Get.</i>MCA.</font></p>		<p><font size="2">Frampton, Peter. 1976. &quot;Do You Feel Like We Do&quot; <i>Frampton Comes Alive.</i>A&amp;M.</font></p>	</body></html>