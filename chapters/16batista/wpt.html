<html>	<head>		<meta http-equiv="content-type" content="text/html;charset=iso-8859-1">		<meta name="generator" content="Adobe GoLive 4">		<title>An Introduction to Sound Sunthesis with Wavelet Packets [ WPT ]</title>		<meta name="Version" content="8.0.3612">		<meta name="Date" content="2/24/97">		<meta name="Template" content="C:\PROGRAMAS\MICROSOFT OFFICE\OFFICE\html.dot">	</head>	<body text="black" link="blue" vlink="purple" bgcolor="white">		<font face="Times New Roman"><b>0. </b></font><a href="index.html"><font face="Times New Roman">Index</font></a><font face="Times New Roman"><b> 1. </b><a href="wavelet.html">Intro</a> <b>2. </b><a href="mathcode.html">Mathematica code</a> <b>3. </b><u>WPT</u> <b>4.</b> <a href="fwt.html">FWT</a> <b>5. </b><a href="ref.html">References</a></font>		<p><font face="Times New Roman">		<hr>		</font></p>		<h3><font face="Times New Roman"><b>3. The Wave Packet Instrument Explained</b></font></h3>		<p><font face="Times New Roman">As you can see, the algorithm is quite clear and simple. The only awkward part to implement in Csound is the last section where the wavepackets are anticonvolved, in a recursive manner. While coding this in C would preferably take advantage of its recursive possibilities, with Csound we must use separate storage areas to maintain the coefficients for all the levels of the wavelet, and call the convolve/anticonvolve code several times inside a main loop. Another particularity resides in programming the sequence of filters to be used (at each level we can use either H, the LPF, or G, the HPF). As you'll see I used a function table to store a sequence of 0's and 1's, with 0 meaning H, and 1 meaning its mirror G. This way, a different sequence of filters and mirror filters can be easily stated, by specifying the corresponding 0s and 1s sequence.</font></p>		<p><font face="Times New Roman">These instrument merely scratches the surface, by allowing you to build a function table with any anticonvolved wavepacket. The resulting table is then used to drive an oscillator. The whole table-generation code is done at i-time, but it shouldnt be so hard to port it to k-time (merely change prefixes and some ugens to k-rate). I've also split the code over several instruments (which must run prior to the actual sounding instruments), for the sake of clarity.</font></p>		<p><font face="Times New Roman">Next we'll be seeing the design of <a href="instruments/wpt.orc">WPT.ORC</a> and <a href="instruments/wpt.sco">WPT.SCO</a>, in some more detail.</font></p>		<p><font face="Times New Roman">Later on, this same instrument will be improved to allow for dynamic shaping of the wavepackets during performance, in order to create a simple 'Wave Packet Synthesizer'. This will be the goal of the last instrument of this section, the <a href="instruments/wsynth.orc">WSYNTH.ORC</a> and <a href="wsynth.sco">WSYNTH.SCO</a> instrument.</font></p>		<p><font face="Times New Roman"><b>WPT.ORC</b></font></p>		<p><font face="Times New Roman">First of all we need some filters. I've added the DAUB4 standard to the original code, apart from that its a mere transposition (you dont wanna mess with these golden numbers).</font></p>		<p><font face="Courier New">;=-=-=-=-=-=-=-=-=-=-=- F I L T E R S -=-=-=-=-=-=-=-=-=-=-=-=-=;<br>		;standard 4<br>		ifn ftgen 1, 0, 4, -2, 0.4829629131445341, 0.8365163037378079, 0.2241438680420134,<br>		-0.1294095225512604<br>		<br>		;standard 10<br>		ifn ftgen 2, 0, 16, -2, 0.160102397974, 0.603829269797, 0.724308528438, 0.138428145901,<br>		-0.242294887066, -0.032244869585, 0.077571493840, -0.006241490213, -0.012580751999,<br>		0.003335725285<br>		<br>		;standard 12<br>		ifn ftgen 3, 0, 16, -2, 0.111540743350, 0.494623890398, 0.751133908021, 0.315250351709,<br>		-0.226264693965, -0.129766867567, 0.097501605587, 0.027522865530, -0.031582039318,<br>		0.000553842201, 0.004777257511, -0.001077301085<br>		<br>		;coifman 12<br>		ifn ftgen 4, 0, 16, -2, 1.15875967387, -.02932013798, -.04763959031, .273021046535,<br>		.574682393857, .294867193696, -.0540856070917, -.0420264804608, .0167444101633,<br>		.00396788361296,-.00128920335614, -.000509505399<br>		<br>		;coifman 6<br>		ifn ftgen 5, 0, 8, -2, (sqrt(15)-3.0)/32.0, (1.0-sqrt(15))/32.0, (3.0-sqrt(15))/16.0,<br>		(sqrt(15)+3.0)/16.0, (sqrt(15)+13.0)/32.0, (9.0-sqrt(15))/32.0</font></p>		<p><font face="Times New Roman">Now, we'll be needing a table to store both the filter and the mirror filter, that we actually choose. The filter table can be one of the above, but we need an additional table for the mirror (which will be derived from the chosen filter).</font></p>		<p><font face="Courier New">;mirror filter<br>		ifn ftgen 6, 0, 16, -7, 0, 16, 0</font></p>		<p><font face="Times New Roman">Since these filters have various sizes, I store each one's size in a lookup table:</font></p>		<p><font face="Courier New">;size table<br>		ifn ftgen 7, 0, 8, -2, 4, 10, 12, 12, 6</font></p>		<p><font face="Times New Roman">Finally, to keep track within each instrument, of what filter table numbers are the chosen ones, and their respective size, I use the following global variables to circulate the information:</font></p>		<p><font face="Courier New">gifilt = 0<br>		gimirr = 0<br>		gifsz = 0</font></p>		<p><font face="Times New Roman">As mentioned, we'll be needing space to hold the complete wave-packet pyramid in memory. This sums up to 512+256+128+64+32+16+8+4+2 = 1022. Should you ever want to use a table size bigger than 512, dont forget to update it here accordingly.</font></p>		<p><font face="Courier New">zakinit 1, 1022</font></p>		<p><font face="Times New Roman">We're ready to look at our first instrument. This will just initialize the filters, by calculating the mirror pair for whatever filter was chosen from the score. The original code read:</font></p>		<p><font face="Courier New">Table[ (-1)^n filter[[len+1-n]], {n,1,len}]</font></p>		<p><font face="Times New Roman">So we read the filter table backwards from the end, and each value is multiplied by (-1)^n, where n is the index of the table. This power results in +1 for n even, and -1 for n odd, thus if the fractional part of half the index is zero, the number is even (divisible by two) and the factor is +1; otherwise its -1. The resulting mirror coefficients are written into the mirror filter table, and the global variables are updated.</font></p>		<p><font face="Courier New">instr 1<br>		;=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=;<br>		; MirrorFilter<br>		;=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=;<br>		ifilter = p4<br>		imirror = 6<br>		isztab = 7<br>		ifiltsz table ifilter-1, isztab<br>		indx = 0<br>		loop:<br>		ifil table ifiltsz-indx-1, ifilter<br>		itablew (frac((indx+1)/2)==0 ? +1:-1)*ifil, indx, imirror<br>		indx = indx+1<br>		if (indx&lt;ifiltsz) igoto loop<br>		gifilt = ifilter<br>		gimirr = imirror<br>		gifsz = ifiltsz<br>		endin</font></p>		<p><font face="Times New Roman">The next instrument is a bit more tricky. To generate a toneburst, we must go down the storage area to the level we want to start anticonvolving from, and there write a number of coefficients with a single one and the remain with zeros.</font></p>		<p><font face="Times New Roman">First of all we have some variables storing the p-fields corresponding to the result audio table size (must be a power of two), the size of the wavelet that will be written (must be a smaller power of two), and the position where the 1 will be placed (this can range from 0 to iwavlen-1). Finally istart denotes the start of the storage area, should I need to relocate it easily.</font></p>		<p><font face="Courier New">;=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=;<br>		instr 3<br>		;=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=;<br>		; Toneburst<br>		;=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=;<br>		ivectsz = p4 ; audio table size<br>		iwavlen = p5 ; length of wavelet<br>		i1pos = p6 ; position of the single '1'<br>		istart = 0 ; start of storage area</font></p>		<p><font face="Times New Roman">This bit of the code will now &quot;recursively&quot; run the storage area, down to the level we specified (with the iwavlen variable). We start at position istart, with a wavelet size of 512, and then successively add the wavelet size to the start position (storing it in iovec), and halve the wavelet size (ivlen). We proceed by smaller and smaller steps, till we reach a wavelet of the size specified. Thats the place to write.</font></p>		<p><font face="Courier New">ipass = 0<br>		iovec = istart<br>		ivlen = ivectsz<br>		main:<br>		iivec = iovec<br>		iovec = iivec+ivlen<br>		ivlen = ivlen/2<br>		ipass = ipass+1<br>		if (ivlen&gt;iwavlen) igoto main</font></p>		<p><font face="Times New Roman">Another variable ipass is being incremented during the loop. This marks the position of the sequence table that the current wavelet is referring to, and at the end of the loop stores the sequence table position to start reading (backwards) from, in the anticonvolution instrument.</font></p>		<p><font face="Times New Roman">The following instructions will write the all-zeros-with-a-single-one wavelet at the iovec position:</font></p>		<p><font face="Courier New">ii = 0<br>		loop1:<br>		ziw (ii==i1pos ? 1:0), iovec+ii<br>		ii = ii+1<br>		if (ii&lt;ivlen) igoto loop1</font></p>		<p><font face="Times New Roman">And finally the global variables are updated, to be used in the next instrument.</font></p>		<p><font face="Courier New">givec = iovec<br>		gilen = ivlen<br>		giseq = ipass<br>		endin</font></p>		<p><font face="Times New Roman">The anticonvolution instrument also follows Wickerhauser's code. At first, a bunch of variables are updated to retain all the necessary parameters.</font></p>		<p><font face="Courier New">;=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=;<br>		instr 4<br>		;=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=;<br>		; AntiConvolve<br>		;=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=;<br>		ivector = p4<br>		ivectsz = p5<br>		iseqtab = p6<br>		ifilter = gifilt; filter table number<br>		imirror = gimirr; mirror table number<br>		ifiltsz = gifsz ; filter table size<br>		istart = 0</font></p>		<p><font face="Times New Roman">Now, from here on we will be using some tracking variables: iivec refers at each successive step, to the start of the wavelet (of size ivlen) that we will be anticonvolving; iovec, conversely, corresponds to the initial position for the new resulting wavelet (of size ivlen * 2). At the end, iovec will be equal to istart, and we will have anticonvolved a wavelet of size 256 into our final signal (in this example of final size 512).</font></p>		<p><font face="Courier New">iovec = givec<br>		ivlen = gilen<br>		ipass = giseq<br>		main:</font></p>		<p><font face="Times New Roman">Notice the way the ipass variable is used as index to the sequence table, ultimately determining whether the filter will be applied, or rather its mirror will:</font></p>		<p><font face="Courier New">istp table ipass, iseqtab<br>		ipass = ipass-1<br>		ifilter = (istp==0 ? gifilt:gimirr)</font></p>		<p><font face="Times New Roman">At each pass the output position will be 2 * ivlen less than the input position.</font></p>		<p><font face="Courier New">iivec = iovec<br>		iovec = iivec-ivlen*2</font></p>		<p><font face="Times New Roman">First of all lets initialize the output area with zeros:</font></p>		<p><font face="Courier New">ii = 0<br>		loop0:<br>		ziw 0, iovec+ii<br>		ii = ii+1<br>		if (ii&lt;ivlen*2) igoto loop0</font></p>		<p><font face="Times New Roman">Now for the actual calculation of the new vector. The original code could translate rather freely to C, to something like this:</font></p>		<p><font face="Courier New">OutVector[(2*j+i)%(2*InVecLen)]+=Filter[i]*InVector[j]</font></p>		<p><font face="Times New Roman">The index of the output vector is calculated into the ipos variable, as the remainder of the division of (2j+i) by the new vector length (twice the input length). Next the filter coefficient at position i and the input vector coefficient at position j are read from their locations into respectively i_f and i_v. Finally their product is calculated and added to the output position pointed by iovec + ipos.</font></p>		<p><font face="Courier New">ij = 0<br>		loop1:<br>		ii = 0<br>		loop2:</font></p>		<p><font face="Courier New">ipos = 2*ij+ii-int((2*ij+ii)/(2*ivlen))*2*ivlen<br>		i_f table ii, ifilter<br>		i_v zir iivec+ij<br>		i_vv zir iovec+ipos<br>		i_vv = i_vv+i_v*i_f<br>		ziw i_vv, iovec+ipos<br>		ii = ii+1<br>		if (ii&lt;ifiltsz) igoto loop2<br>		ij = ij+1<br>		if (ij&lt;ivlen) igoto loop1</font></p>		<p><font face="Times New Roman">This calculation is performed within two chained loops j spanning the input vector, and i spanning the filter. At the end of an anticonvolve stage, we start again with the output vector we just generated acting as the new input vector for the next stage. The new vector length will be twice the preceding one:</font></p>		<p><font face="Courier New">ivlen = ivlen*2<br>		if (ivlen&lt;ivectsz) igoto main</font></p>		<p><font face="Times New Roman">&nbsp;Ok, so our anticonvolved toneburst is now calculated, and stored at the beginning of Zak space, ready for us to load into a function table. While we're at it, we might as well find the minimum and maximum values, cause we'll need to do some normalization later on.</font></p>		<p><font face="Courier New">indx = 0<br>		imin = 32767<br>		imax = -32768<br>		load:<br>		isig zir istart+indx<br>		if (isig&lt;=imax) igoto next1 ; find maximum and minimum<br>		imax = isig ; to perform normalization<br>		igoto next2<br>		next1: if (isig&gt;=imin) igoto next2<br>		imin = isig<br>		next2: itablew isig, indx, ivector<br>		indx = indx+1<br>		if (indx&lt;ivectsz) igoto load</font></p>		<p><font face="Times New Roman">Another pass through the table to normalize it... Notice that the (isig-imin) / (imax-imin) calculation, scales the resulting isig to the range 0.0 to 1.0. Suffice to subtract .5 from it, to have the table centered in amplitude.</font></p>		<p><font face="Courier New">indx = 0<br>		norm:<br>		isig table indx, ivector<br>		isig = (isig-imin)/(imax-imin)-.5 ; scale the table to the<br>		itablew isig, indx, ivector ; range [-.5, +.5]<br>		indx = indx+1<br>		if (indx&lt;ivectsz) igoto norm<br>		<br>		endin</font></p>		<p><font face="Times New Roman">&nbsp;Finally we can hear the function table we generated. This following instrument does that in the simplest of ways. A mere linear envelope, and a frequency sweep.</font></p>		<p><font face="Courier New">;=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=;<br>		instr 5<br>		;=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=;<br>		; Test : A simple oscilator<br>		;=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=;<br>		ivector = p4<br>		iamp = p5<br>		ifrq0 = p6<br>		ifrq1 = p7<br>		<br>		kamp linseg 0, p3/8 , iamp, 3*p3/4, iamp, p3/8, 0<br>		kfrq linseg ifrq0, p3, ifrq1<br>		asig oscil kamp, kfrq, ivector<br>		<br>		out asig<br>		<br>		endin</font></p>		<p><font face="Times New Roman">And that ends the orchestra definition.</font></p>		<p><font face="Times New Roman">The score file provides all the initialization parameters for the wave-packet, as well as whatever data is needed for the actual sounding instrument(s) to perform.</font></p>		<h3><font face="Times New Roman"><b>WPT.SCO</b></font></h3>		<p><font face="Times New Roman">We'll need a table to store the generated toneburst:</font></p>		<p><font face="Courier New">;signal table<br>		f8 0 512 -7 0 512 0</font></p>		<p><font face="Times New Roman">As well as a means to choose the actual anticonvolved wave-packet, by specifying the sequence of H's and G's that it'll be undergoing. This is done with the 0's and 1's sequence of this next table (the 512 entry is not needed, but it helps clarity).</font></p>		<p><font face="Times New Roman">;filter sequence table</font></p>		<p><font face="Times New Roman">		<table cellspacing="0" border="0" width="662">			<tr>				<td width="17%" valign="top">;</td>				<td width="9%" valign="top">					<center>						512</center>				</td>				<td width="9%" valign="top">					<center>						256</center>				</td>				<td width="9%" valign="top">					<center>						128</center>				</td>				<td width="9%" valign="top">					<center>						64</center>				</td>				<td width="9%" valign="top">					<center>						32</center>				</td>				<td width="9%" valign="top">					<center>						16</center>				</td>				<td width="9%" valign="top">					<center>						8</center>				</td>				<td width="9%" valign="top">					<center>						4</center>				</td>				<td width="9%" valign="top">					<center>						2</center>				</td>			</tr>			<tr>				<td width="17%" valign="top">f9 0 16 -2</td>				<td width="9%" valign="top">					<center>						0</center>				</td>				<td width="9%" valign="top">					<center>						1</center>				</td>				<td width="9%" valign="top">					<center>						0</center>				</td>				<td width="9%" valign="top">					<center>						1</center>				</td>				<td width="9%" valign="top">					<center>						1</center>				</td>				<td width="9%" valign="top">					<center>						0</center>				</td>				<td width="9%" valign="top">					<center>						0</center>				</td>				<td width="9%" valign="top">					<center>						0</center>				</td>				<td width="9%" valign="top">					<center>						0</center>				</td>			</tr>		</table>		</font></p>		<p><font face="Times New Roman">Now lets choose a filter (from the five provided in the orchestra)...</font></p>		<p><font face="Times New Roman">;initialize filter</font></p>		<p><font face="Times New Roman">		<table cellspacing="0" border="0" width="382">			<tr>				<td width="19%" valign="top">;</td>				<td width="32%" valign="top">					<center>						filter (1-5)</center>				</td>				<td width="49%" valign="top">&nbsp;</td>			</tr>			<tr>				<td width="19%" valign="top">i1 0 0</td>				<td width="32%" valign="top">					<center>						1</center>				</td>				<td width="49%" valign="top">; try filters 1 to 5</td>			</tr>		</table>		</font></p>		<p><font face="Times New Roman">... as well as a wavelet size, and the position of the single one.</font></p>		<p><font face="Courier New">;* * ToneBurst * *</font></p>		<p><font face="Times New Roman">		<table cellspacing="0" border="0" width="633">			<tr>				<td width="11%" valign="top">;</td>				<td width="10%" valign="top">					<center>						vecsz</center>				</td>				<td width="10%" valign="top">					<center>						wavsz</center>				</td>				<td width="10%" valign="top">					<center>						1pos</center>				</td>				<td width="59%" valign="top">; try any 2&lt;=wavsz&lt;=512 (must be pow'of-2)</td>			</tr>			<tr>				<td width="11%" valign="top">i3 0 0</td>				<td width="10%" valign="top">					<center>						512</center>				</td>				<td width="10%" valign="top">					<center>						4</center>				</td>				<td width="10%" valign="top">					<center>						0</center>				</td>				<td width="59%" valign="top">; try 1pos from 0 to wavsz-1</td>			</tr>		</table>		</font></p>		<p><font face="Times New Roman">&nbsp;</font></p>		<p><font face="Times New Roman">Finally, anticonvolve the specified wave packet, using the chosen sequence of filters, into the resulting function table.</font></p>		<p><font face="Courier New">;* * AntiConvolve * *</font></p>		<p><font face="Times New Roman">		<table cellspacing="0" border="0" width="259">			<tr>				<td width="27%" valign="top">;</td>				<td width="24%" valign="top">					<center>						vectab</center>				</td>				<td width="24%" valign="top">					<center>						vecsz</center>				</td>				<td width="24%" valign="top">					<center>						seqtab</center>				</td>			</tr>			<tr>				<td width="27%" valign="top">i4 0 0</td>				<td width="24%" valign="top">					<center>						8</center>				</td>				<td width="24%" valign="top">					<center>						512</center>				</td>				<td width="24%" valign="top">					<center>						9</center>				</td>			</tr>		</table>		</font></p>		<p><font face="Times New Roman">Now just play the generated table, by whatever method you see fit.</font></p>		<p><font face="Courier New">; Lets hear it:</font></p>		<p><font face="Times New Roman">		<table cellspacing="0" border="0" width="373">			<tr>				<td width="12%" valign="top">;</td>				<td width="12%" valign="top">str</td>				<td width="12%" valign="top">dur</td>				<td width="17%" valign="top">					<center>						vectab</center>				</td>				<td width="17%" valign="top">					<center>						dynrng</center>				</td>				<td width="15%" valign="top">					<center>						frq0</center>				</td>				<td width="15%" valign="top">					<center>						frq1</center>				</td>			</tr>			<tr>				<td width="12%" valign="top">i5</td>				<td width="12%" valign="top">0</td>				<td width="12%" valign="top">5</td>				<td width="17%" valign="top">					<center>						8</center>				</td>				<td width="17%" valign="top">					<center>						30000</center>				</td>				<td width="15%" valign="top">					<center>						1</center>				</td>				<td width="15%" valign="top">					<center>						55</center>				</td>			</tr>		</table>		</font></p>		<p><font face="Courier New">e</font></p>		<p><font face="Times New Roman">Should you want to experiment with bigger wavelets, all there is to it is to update all &quot;512&quot; values in this score to read a higher power of two. You will need to resize Zak-space within the orchestra, and the sequence table will need more entries at the start, but that should be it.</font></p>		<p><font face="Times New Roman">		<hr>		</font></p>		<h3><font face="Times New Roman"><b>A Wave-packet Synthesizer</b></font></h3>		<p><font face="Times New Roman">Using the code from this last instrument, it is a trivial matter to program a 'dynamic' version, that allows the toneburst wavetable to change during performance. This is the goal of the <a href="instruments/wsynth.orc">WSYNTH.ORC</a> and <a href="wsynth.sco">WSYNTH.SCO</a> instrument, which we will now discuss briefly.</font></p>		<p><font face="Times New Roman">All relevant parameters are changed within the score, so thats what we'll be seeing.</font></p>		<p><font face="Times New Roman">First of all we have the signal table declaration. No surprises here, since its just the same as the previous instrument.</font></p>		<p><font face="Courier New">;signal table</font></p>		<p><font face="Courier New">f10 0 8192 -7 0 8192 0</font></p>		<p><font face="Times New Roman">I've used a bigger table now, to have some added sound fidelity, but as long as the table size is coherent all over the score, you can choose any power of two (dont forget that you must make room in the zak-space allocation, for the signal size you'll be using).</font></p>		<p><font face="Times New Roman">Next we have the filter choosing instrument. This selects one of the five available filters and makes that particular one the active filter, until eventually some other instance of this instrument overrides it. This instrument can have its duration set to zero, since all processing is done at i-time.</font></p>		<p><font face="Courier New">;filter control</font></p>		<p><font face="Times New Roman">		<table cellspacing="0" border="0" width="311">			<tr>				<td width="16%" valign="top">;</td>				<td width="20%" valign="top">					<center>						str</center>				</td>				<td width="21%" valign="top">					<center>						dur</center>				</td>				<td width="42%" valign="top">					<center>						filter (1-5)</center>				</td>			</tr>			<tr>				<td width="16%" valign="top">i1</td>				<td width="20%" valign="top">					<center>						0</center>				</td>				<td width="21%" valign="top">					<center>						0</center>				</td>				<td width="42%" valign="top">					<center>						1</center>				</td>			</tr>			<tr>				<td width="16%" valign="top">i1</td>				<td width="20%" valign="top">					<center>						1</center>				</td>				<td width="21%" valign="top">					<center>						0</center>				</td>				<td width="42%" valign="top">					<center>						5</center>				</td>			</tr>			<tr>				<td width="16%" valign="top">i1</td>				<td width="20%" valign="top">					<center>						3</center>				</td>				<td width="21%" valign="top">					<center>						0</center>				</td>				<td width="42%" valign="top">					<center>						3</center>				</td>			</tr>			<tr>				<td width="16%" valign="top">i1</td>				<td width="20%" valign="top">					<center>						4</center>				</td>				<td width="21%" valign="top">					<center>						0</center>				</td>				<td width="42%" valign="top">					<center>						5</center>				</td>			</tr>			<tr>				<td width="16%" valign="top">i1</td>				<td width="20%" valign="top">					<center>						5</center>				</td>				<td width="21%" valign="top">					<center>						0</center>				</td>				<td width="42%" valign="top">					<center>						1</center>				</td>			</tr>			<tr>				<td width="16%" valign="top">i1</td>				<td width="20%" valign="top">					<center>						6</center>				</td>				<td width="21%" valign="top">					<center>						0</center>				</td>				<td width="42%" valign="top">					<center>						5</center>				</td>			</tr>			<tr>				<td width="16%" valign="top">i1</td>				<td width="20%" valign="top">					<center>						7</center>				</td>				<td width="21%" valign="top">					<center>						0</center>				</td>				<td width="42%" valign="top">					<center>						1</center>				</td>			</tr>		</table>		</font></p>		<p><font face="Times New Roman">In a similar manner, the next instrument chooses the particular wave-packet that will be active in the signal table. This particular wavepacket will be sounding until another instance of this instrument changes it to another wavepacket. You choose each particular wavepacket by specifying the sequence of low-pass or high-pass filters it will be anticonvolved through. This is done with the zeros and ones in this instrument, with 0 meaning H (the low pass filter) and 1 meaning G (the high-pass filter). A good deal of experimentation is needed with this sequence, in order to find suitable wavepackets for a given application. Notice that in this instrument the duration still does not have significance, since once more its code is all done at i-time.</font></p>		<p><font face="Courier New">; filter sequence table</font></p>		<p><font face="Times New Roman">		<table cellspacing="0" border="0" width="633">			<tr>				<td width="7%" valign="top">;</td>				<td width="7%" valign="top">&nbsp;</td>				<td width="7%" valign="top">&nbsp;</td>				<td width="7%" valign="top">					<center>						4096</center>				</td>				<td width="7%" valign="top">					<center>						2048</center>				</td>				<td width="7%" valign="top">					<center>						1024</center>				</td>				<td width="7%" valign="top">					<center>						512</center>				</td>				<td width="7%" valign="top">					<center>						256</center>				</td>				<td width="7%" valign="top">					<center>						128</center>				</td>				<td width="7%" valign="top">					<center>						64</center>				</td>				<td width="7%" valign="top">					<center>						32</center>				</td>				<td width="7%" valign="top">					<center>						16</center>				</td>				<td width="7%" valign="top">					<center>						8</center>				</td>				<td width="7%" valign="top">					<center>						4</center>				</td>				<td width="7%" valign="top">					<center>						2</center>				</td>			</tr>			<tr>				<td width="7%" valign="top">i2</td>				<td width="7%" valign="top">					<center>						0</center>				</td>				<td width="7%" valign="top">					<center>						2</center>				</td>				<td width="7%" valign="top">					<center>						0</center>				</td>				<td width="7%" valign="top">					<center>						1</center>				</td>				<td width="7%" valign="top">					<center>						0</center>				</td>				<td width="7%" valign="top">					<center>						0</center>				</td>				<td width="7%" valign="top">					<center>						0</center>				</td>				<td width="7%" valign="top">					<center>						0</center>				</td>				<td width="7%" valign="top">					<center>						0</center>				</td>				<td width="7%" valign="top">					<center>						0</center>				</td>				<td width="7%" valign="top">					<center>						0</center>				</td>				<td width="7%" valign="top">					<center>						0</center>				</td>				<td width="7%" valign="top">					<center>						0</center>				</td>				<td width="7%" valign="top">					<center>						0</center>				</td>			</tr>			<tr>				<td width="7%" valign="top">i2</td>				<td width="7%" valign="top">					<center>						+</center>				</td>				<td width="7%" valign="top">					<center>						2</center>				</td>				<td width="7%" valign="top">					<center>						0</center>				</td>				<td width="7%" valign="top">					<center>						0</center>				</td>				<td width="7%" valign="top">					<center>						0</center>				</td>				<td width="7%" valign="top">					<center>						0</center>				</td>				<td width="7%" valign="top">					<center>						0</center>				</td>				<td width="7%" valign="top">					<center>						0</center>				</td>				<td width="7%" valign="top">					<center>						0</center>				</td>				<td width="7%" valign="top">					<center>						1</center>				</td>				<td width="7%" valign="top">					<center>						1</center>				</td>				<td width="7%" valign="top">					<center>						1</center>				</td>				<td width="7%" valign="top">					<center>						1</center>				</td>				<td width="7%" valign="top">					<center>						1</center>				</td>			</tr>			<tr>				<td width="7%" valign="top">i2</td>				<td width="7%" valign="top">					<center>						+</center>				</td>				<td width="7%" valign="top">					<center>						1</center>				</td>				<td width="7%" valign="top">					<center>						0</center>				</td>				<td width="7%" valign="top">					<center>						0</center>				</td>				<td width="7%" valign="top">					<center>						1</center>				</td>				<td width="7%" valign="top">					<center>						0</center>				</td>				<td width="7%" valign="top">					<center>						0</center>				</td>				<td width="7%" valign="top">					<center>						0</center>				</td>				<td width="7%" valign="top">					<center>						1</center>				</td>				<td width="7%" valign="top">					<center>						0</center>				</td>				<td width="7%" valign="top">					<center>						1</center>				</td>				<td width="7%" valign="top">					<center>						0</center>				</td>				<td width="7%" valign="top">					<center>						1</center>				</td>				<td width="7%" valign="top">					<center>						0</center>				</td>			</tr>			<tr>				<td width="7%" valign="top">i2</td>				<td width="7%" valign="top">					<center>						+</center>				</td>				<td width="7%" valign="top">					<center>						1</center>				</td>				<td width="7%" valign="top">					<center>						1</center>				</td>				<td width="7%" valign="top">					<center>						1</center>				</td>				<td width="7%" valign="top">					<center>						0</center>				</td>				<td width="7%" valign="top">					<center>						0</center>				</td>				<td width="7%" valign="top">					<center>						0</center>				</td>				<td width="7%" valign="top">					<center>						0</center>				</td>				<td width="7%" valign="top">					<center>						0</center>				</td>				<td width="7%" valign="top">					<center>						0</center>				</td>				<td width="7%" valign="top">					<center>						0</center>				</td>				<td width="7%" valign="top">					<center>						0</center>				</td>				<td width="7%" valign="top">					<center>						1</center>				</td>				<td width="7%" valign="top">					<center>						1</center>				</td>			</tr>			<tr>				<td width="7%" valign="top">i2</td>				<td width="7%" valign="top">					<center>						+</center>				</td>				<td width="7%" valign="top">					<center>						2</center>				</td>				<td width="7%" valign="top">					<center>						0</center>				</td>				<td width="7%" valign="top">					<center>						0</center>				</td>				<td width="7%" valign="top">					<center>						0</center>				</td>				<td width="7%" valign="top">					<center>						0</center>				</td>				<td width="7%" valign="top">					<center>						0</center>				</td>				<td width="7%" valign="top">					<center>						0</center>				</td>				<td width="7%" valign="top">					<center>						0</center>				</td>				<td width="7%" valign="top">					<center>						0</center>				</td>				<td width="7%" valign="top">					<center>						0</center>				</td>				<td width="7%" valign="top">					<center>						1</center>				</td>				<td width="7%" valign="top">					<center>						1</center>				</td>				<td width="7%" valign="top">					<center>						1</center>				</td>			</tr>		</table>		</font></p>		<p><font face="Times New Roman">The next instrument now combines what were the 'toneburst' and 'anticonvolve' instruments in our last score. Here you can set the wavelet size (lowest level to go) and the single one's position. These are not fundamental parameters, so you may prefer to mess with filters and filter sequence instead. Nevertheless they're here, should you want to change them.</font></p>		<p><font face="Times New Roman">One important thing, though : this instrument must be kept running during the whole performance, otherwise it wont reshape the signal table each time that either the filter, or the filter sequence changes.</font></p>		<p><font face="Courier New">;* * ToneBurst * *</font></p>		<p><font face="Times New Roman">		<table cellspacing="0" border="0" width="401">			<tr>				<td width="13%" valign="top">;</td>				<td width="15%" valign="top">					<center>						str</center>				</td>				<td width="15%" valign="top">					<center>						dur</center>				</td>				<td width="15%" valign="top">					<center>						vectab</center>				</td>				<td width="15%" valign="top">					<center>						vecsz</center>				</td>				<td width="15%" valign="top">					<center>						wavsz</center>				</td>				<td width="15%" valign="top">					<center>						1pos</center>				</td>			</tr>			<tr>				<td width="13%" valign="top">i3</td>				<td width="15%" valign="top">					<center>						0</center>				</td>				<td width="15%" valign="top">					<center>						8</center>				</td>				<td width="15%" valign="top">					<center>						10</center>				</td>				<td width="15%" valign="top">					<center>						8192</center>				</td>				<td width="15%" valign="top">					<center>						2</center>				</td>				<td width="15%" valign="top">					<center>						0</center>				</td>			</tr>		</table>		</font></p>		<p><font face="Times New Roman">Finally we have the basic sound generation instrument, a simple oscil reading the generated sound table. I strongly advise changing this instrument into something more sophisticated, maybe with resonant low-pass filtering to smooth some of the brightest timbres these tonebursts are capable of generating.</font></p>		<p><font face="Times New Roman">		<table cellspacing="0" border="0" width="372">			<tr>				<td width="12%" valign="top">;</td>				<td width="12%" valign="top">					<center>						str</center>				</td>				<td width="12%" valign="top">					<center>						dur</center>				</td>				<td width="17%" valign="top">					<center>						vectab</center>				</td>				<td width="17%" valign="top">					<center>						dynrng</center>				</td>				<td width="15%" valign="top">					<center>						frq0</center>				</td>				<td width="15%" valign="top">					<center>						frq1</center>				</td>			</tr>			<tr>				<td width="12%" valign="top">i5</td>				<td width="12%" valign="top">					<center>						0</center>				</td>				<td width="12%" valign="top">					<center>						1.8</center>				</td>				<td width="17%" valign="top">					<center>						10</center>				</td>				<td width="17%" valign="top">					<center>						30000</center>				</td>				<td width="15%" valign="top">					<center>						44</center>				</td>				<td width="15%" valign="top">					<center>						22</center>				</td>			</tr>			<tr>				<td width="12%" valign="top">i5</td>				<td width="12%" valign="top">					<center>						2</center>				</td>				<td width="12%" valign="top">					<center>						1.8</center>				</td>				<td width="17%" valign="top">					<center>						10</center>				</td>				<td width="17%" valign="top">					<center>						30000</center>				</td>				<td width="15%" valign="top">					<center>						8</center>				</td>				<td width="15%" valign="top">					<center>						16</center>				</td>			</tr>			<tr>				<td width="12%" valign="top">i5</td>				<td width="12%" valign="top">					<center>						4</center>				</td>				<td width="12%" valign="top">					<center>						.8</center>				</td>				<td width="17%" valign="top">					<center>						10</center>				</td>				<td width="17%" valign="top">					<center>						30000</center>				</td>				<td width="15%" valign="top">					<center>						10</center>				</td>				<td width="15%" valign="top">					<center>						6</center>				</td>			</tr>			<tr>				<td width="12%" valign="top">i5</td>				<td width="12%" valign="top">					<center>						5</center>				</td>				<td width="12%" valign="top">					<center>						.8</center>				</td>				<td width="17%" valign="top">					<center>						10</center>				</td>				<td width="17%" valign="top">					<center>						30000</center>				</td>				<td width="15%" valign="top">					<center>						2</center>				</td>				<td width="15%" valign="top">					<center>						8</center>				</td>			</tr>			<tr>				<td width="12%" valign="top">i5</td>				<td width="12%" valign="top">					<center>						6</center>				</td>				<td width="12%" valign="top">					<center>						.8</center>				</td>				<td width="17%" valign="top">					<center>						10</center>				</td>				<td width="17%" valign="top">					<center>						30000</center>				</td>				<td width="15%" valign="top">					<center>						11</center>				</td>				<td width="15%" valign="top">					<center>						22</center>				</td>			</tr>			<tr>				<td width="12%" valign="top">i5</td>				<td width="12%" valign="top">					<center>						7</center>				</td>				<td width="12%" valign="top">					<center>						1.3</center>				</td>				<td width="17%" valign="top">					<center>						10</center>				</td>				<td width="17%" valign="top">					<center>						30000</center>				</td>				<td width="15%" valign="top">					<center>						33</center>				</td>				<td width="15%" valign="top">					<center>						1</center>				</td>			</tr>		</table>		</font></p>		<p><font face="Times New Roman">And thats all, folks. Please take some time to vary the most important parameters, namely the filter type, and sequence, as this experimentation is paramount in order to find interesting combinations. The complete orchestra <a href="instruments/wsynth.orc">WSYNTH.ORC</a> and score <a href="wsynth.sco">WSYNTH.SCO</a> are given here for you to try.</font></p>		<p><font face="Times New Roman">Although this instruments per se may not yield more that beautiful shapes and unusual timbres, I think there is a lot that can be done with these sounds, once they are further processed (specially after filtering, which is one of the things these sounds are crying out for). The overall structure of the instruments is not that complex, so it shouldnt be so hard to include the sound generation core, in your own orc's and sco's.</font></p>		<p><font face="Times New Roman">		<hr>		</font></p>		<p><font face="Times New Roman"><b>0. </b><a href="index.html">Index</a><b> 1. </b><a href="wavelet.html">Intro</a> <b>2. </b><a href="mathcode.html">Mathematica code</a> <b>3. </b><u>WPT</u> <b>4.</b> <a href="fwt.html">FWT</a> <b>5. </b><a href="ref.html">References</a></font>	</body></html>